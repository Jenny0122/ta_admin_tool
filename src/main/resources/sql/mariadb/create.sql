/* 사용자 정보 */
CREATE TABLE WISETM_USER_INFO (
	USER_ID VARCHAR(100) NOT NULL COMMENT '사용자ID'
  , USER_PW VARCHAR(500) NOT NULL COMMENT '패스워드'
  , USER_NAME VARCHAR(100) NOT NULL COMMENT '사용자명'
  , USER_EMAIL VARCHAR(500) COMMENT '이메일'
  , USER_AUTH VARCHAR(10) COMMENT '권한'						/* ADMIN : 관리자, USER : 사용자 */
  , USE_YN VARCHAR(1) COMMENT '사용여부'
  , CRE_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록날짜'
  , CRE_USER VARCHAR(100) COMMENT '등록자ID'
  , MOD_DT TIMESTAMP COMMENT '수정날짜'
  , MOD_USER VARCHAR(100) COMMENT '수정자ID'
  , PRIMARY KEY (USER_ID)
) ENGINE=InnoDB DEFAULT CHARSET=UTF8 COMMENT='사용자 정보'


/* 컬렉션 정보 */
CREATE TABLE WISETM_COLLECTIONS (
	COLLECTION_ID INT NOT NULL COMMENT '컬렉션 ID'
  , COLLECTION_NAME VARCHAR(50) COMMENT '이름'
  , COLLECTION_TYPE VARCHAR(20) COMMENT '컬렉션구분'				/* CLASSIFICATION / EMOTION */
  , COLLECTION_JOB VARCHAR(20) COMMENT '작업구분'					/* ANALYSIS / VERIFIACATION */
  , COLLECTION_DESC VARCHAR(500) COMMENT '설명'
  , COLLECTION_OWNER VARCHAR(100) COMMENT '소유자ID'
  , FIELD_INFO LONGTEXT COMMENT '문서 구조'
  , ORIGINAL_FIELD_INFO LONGTEXT COMMENT '원본 문서 구조'
  , DOCUMENT_FIELD LONGTEXT COMMENT ' 문서 필드'				/* 조회용 */
  , CRE_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록일자'
  , CRE_USER VARCHAR(100) COMMENT '등록자ID'
  , MOD_DT TIMESTAMP COMMENT '수정날짜'
  , MOD_USER VARCHAR(100) COMMENT '수정자ID'
  , PRIMARY KEY (COLLECTION_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='컬렉션 정보';


/* 컬렉션 문서정보 */
CREATE TABLE WISETM_DOCUMENTS (
    DOCUMENT_ID INT NOT NULL COMMENT '문서 ID'
  , COLLECTION_ID INT NOT NULL COMMENT '컬렉션 ID'
  , DOCUMENT_CONTENT JSON COMMENT '문서 내용'
  , PRIMARY KEY (DOCUMENT_ID, COLLECTION_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='컬렉션 문서 정보';


/* 파일 업로드 정보 */
CREATE TABLE WISETM_IMPORT_PROGRESS (
    IMPORT_ID INT NOT NULL COMMENT '업로드 ID'
  , RESOURCE_TYPE VARCHAR(20) COMMENT '업로드 대상'				/* COLLECTION : 컬렉션, DICTIONARY : 사전 */
  , RESOURCE_ID VARCHAR(20) COMMENT '업로드 대상 ID'				/* COLLECTION_ID or DICTIONARY_ID */
  , FILE_NAME VARCHAR(500) COMMENT '파일명'
  , LAST_MODIFIED TIMESTAMP COMMENT '업로드 일자'
  , FILE_SIZE LONG COMMENT '파일크기'
  , TOTAL_COUNT INT COMMENT '전체건수'
  , VALID_COUNT INT COMMENT '성공건수'
  , ERROR_HANDLE VARCHAR(10) COMMENT '에러 제어방식'				/* SKIP : 무시하고 진행, STOP : 진행 중단 */
  , PROGRESS VARCHAR(20) COMMENT '결과'							/* WAITING : 대기중, IN_PROGRESS : 진행중, SUCCESS : 전체성공, PARTIAL_SUCCESS : 부분성공, FAILURE : 실패 */
  , LOG_TEXT LONGTEXT COMMENT '로그'
  , IMPORT_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '업로드 일시'
  , PRIMARY KEY (IMPORT_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='파일 업로드 정보';


/* 사전 정보 */
CREATE TABLE WISETM_DICTIONARIES (
	DICTIONARY_ID int not null comment '사전 ID'
  , DICTIONARY_NAME VARCHAR(100) COMMENT '사전 이름' 
  , DICTIONARY_TYPE varchar(20) COMMENT '사전 구분'				/* WHITE : 수용어, BLANK : 불용어 */
  , DICTIONARY_DESC varchar(500) COMMENT '사전 설명'
  , DICTIONARY_SHARED_YN varchar(1) COMMENT '공통 사전 여부'
  , DICTIONARY_OWNER varchar(100) COMMENT '사전 소유자'
  , CRE_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록날짜'
  , CRE_USER VARCHAR(100) COMMENT '등록자ID'
  , MOD_DT TIMESTAMP COMMENT '수정날짜'
  , MOD_USER VARCHAR(100) COMMENT '수정자ID'
  , PRIMARY KEY (DICTIONARY_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='사전 정보';


/* 엔트리 정보 */
CREATE TABLE WISETM_ENTRIES (
	ENTRY_ID int not null comment '엔트리 ID'
  , DICTIONARY_ID int not null comment '사전 ID'
  , ENTRY_CONTENT VARCHAR(100) COMMENT '엔트리' 
  , PRIMARY KEY (ENTRY_ID, DICTIONARY_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='엔트리 정보';


/* 동의어 정보 */
CREATE TABLE WISETM_SYNONYM (
	SYNONYM_ID int not null comment '동의어 ID'
  , ENTRY_ID int not null comment '엔트리 ID'
  , DICTIONARY_ID int not null comment '사전 ID'
  , SYNONYM_CONTENT varchar(100) COMMENT '동의어' 
  , PRIMARY KEY (SYNONYM_ID, ENTRY_ID, DICTIONARY_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='동의어 정보';


/* 활동이력 정보 */
CREATE TABLE WISETM_ACTION_HISTORY (
	ACTION_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '활동일시'
  , ACTION_TYPE VARCHAR(50) COMMENT '활동타입'
  , RESOURCE_ID INT COMMENT '리소스 ID'
  , RESOURCE_TYPE VARCHAR(20) COMMENT '리소스 유형'				/* COLLECTION : 컬렉션, DICTIONARY : 사전 */
  , ACTION_MSG VARCHAR(500) COMMENT '활동내역'
  , ACTION_USER VARCHAR(100) COMMENT '사용자 ID'
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='사전 정보';


/* 서버 정보 */
CREATE TABLE WISETM_SERVER (
	SERVER_ID int not null comment '서버 ID'
	SERVER_NAME VARCHAR(100) not null comment '서버 이름'
	SERVER_DESC VARCHAR(500) not null comment '설명'
	SERVER_TYPE VARCHAR(10) not null comment '서버 구분'			/* TEST / PROD */
  , SERVER_IP VARCHAR(15) not null comment 'IP 주소'
  , SERVER_PORT int not null comment 'PORT'
  , CRE_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록날짜'
  , CRE_USER VARCHAR(100) COMMENT '등록자ID'
  , MOD_DT TIMESTAMP COMMENT '수정날짜'
  , MOD_USER VARCHAR(100) COMMENT '수정자ID'
  , PRIMARY KEY (SERVER_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='서버 정보';


/* 프로젝트 정보 */
CREATE TABLE WISETM_PROJECTS (
	PROJECT_ID INT NOT NULL COMMENT '프로젝트 ID'
  , PROJECT_NAME VARCHAR(50) COMMENT '프로젝트명'
  , PROJECT_DESC VARCHAR(500) COMMENT '프로젝트 설명'
  , PROJECT_OWNER VARCHAR(50) COMMENT '소유자'
  , CRE_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록날짜'
  , CRE_USER VARCHAR(100) COMMENT '등록자ID'
  , MOD_DT TIMESTAMP COMMENT '수정날짜'
  , MOD_USER VARCHAR(100) COMMENT '수정자ID'
  , PRIMARY KEY (PROJECT_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='프로젝트 정보';


/* 서비스(테스크) 정보 */
CREATE TABLE WISETM_TASK (
	TASK_ID INT NOT NULL COMMENT '테스크 ID'
  , TASK_NAME VARCHAR(50) COMMENT '테스크명'
  , TASK_TYPE VARCHAR(20) COMMENT '테스크 구분'
  , PROJECT_ID INT COMMENT '프로젝트 ID'
  , COLLECTION_ID INT COMMENT '컬렉션 ID'							/* 프로젝트가 학습 시 사용할 컬렉션 ID */
  , TASK_CONFIG JSON COMMENT '테스크 설정정보'
  , MODEL_NAME VARCHAR(200) COMMENT '모델명'
  , MODEL_FILE VARCHAR(200) COMMENT '모델파일'
  , ENABLED VARCHAR(1) COMMENT '사용여부'
  , CRE_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록날짜'
  , CRE_USER VARCHAR(100) COMMENT '등록자ID'
  , MOD_DT TIMESTAMP COMMENT '수정날짜'
  , MOD_USER VARCHAR(100) COMMENT '수정자ID'
  , LAST_ANALYZE_DT TIMESTAMP COMMENT '마지막 분석일시'
  , PRIMARY KEY (TASK_ID, PROJECT_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='서비스(테스크) 정보';


/* 스케쥴 정보 */
CREATE TABLE WISETM_SCHEDULE (
	SCHEDULE_ID INT NOT NULL COMMENT '스케쥴 ID'
  , SCHEDULE_NAME VARCHAR(50) COMMENT '스케쥴명'
  , SCHEDULE_TYPE VARCHAR(10) COMMENT '스케쥴 타입'
  , START_DT VARCHAR(8) COMMENT '시작일자'
  , START_TIME VARCHAR(2) COMMENT '시작시간'
  , END_DT VARCHAR(8) COMMENT '종료일자'
  , END_TIME VARCHAR(2) COMMENT '종료시간'
  , EXECUTE_INTERVAL INT(2) COMMENT '실행간격'
  , LAST_EXECUTE_DT TIMESTAMP COMMENT '마지막 실행일시'
  , LAST_EXECUTE_STATUS VARCHAR(20) COMMENT '마지막 실행상태'
  , TASK_ID NUMBER(11)
  , USE_YN VARCHAR(1) COMMENT '사용여부'
  , CRE_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록날짜'
  , CRE_USER VARCHAR(100) COMMENT '등록자ID'
  , MOD_DT TIMESTAMP COMMENT '수정날짜'
  , MOD_USER VARCHAR(100) COMMENT '수정자ID'
  , PRIMARY KEY (SCHEDULE_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='스케쥴 정보';


/* 분석결과 */
CREATE TABLE WISETM_ANALYZE_RESULT (
	RESULT_ID int not null comment '결과 ID'
  , TASK_ID int COMMENT '서비스 ID' 
  , PROJECT_ID int COMMENT '프로젝트 ID'
  , RESULT_CONTENT JSON COMMENT '분석내용'
  , CRE_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '생성일자'
  , PRIMARY KEY (RESULT_ID, TASK_ID, PROJECT_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='분석결과';


/* 재부팅 진행모듈 정보 */
CREATE TABLE WISETM_REBOOT_STATUS (
    SERVER_IP VARCHAR(15) COMMENT '서버 IP'
  , SERVER_PORT VARCHAR(11)  COMMENT '서버 Port'
) ENGINE=InnoDB DEFAULT CHARSET=UTF8 COMMENT='재부팅 진행모듈 정보';